<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>PCAP Walkthrough – CarnotEngine</title><meta name="viewport" content="width=device-width,initial-scale=1"><style>body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif;max-width:860px;margin:0 auto;padding:2rem;line-height:1.5;background:#0d1117;color:#e6edf3}h1,h2{color:#6ea8fe}code{background:#1e2530;padding:.15rem .4rem;border-radius:4px}pre{background:#1e2530;padding:1rem;border-radius:8px;overflow:auto}a{color:#6ea8fe}</style></head><body><h1>PCAP Walkthrough</h1><p>This walkthrough shows how a raw packet capture of TLS handshakes aligns with runtime eBPF-derived handshake events and the resulting CryptoBOM observations.</p><h2>1. Capture</h2><pre><code>sudo tcpdump -i eth0 -w sample.pcap 'tcp port 443'</code></pre><h2>2. Extract ClientHello Metadata</h2><p>Tools like <code>tshark</code> can extract SNI and offered groups:</p><pre><code>tshark -r sample.pcap -Y 'tls.handshake.type==1' \
  -T fields -e frame.time_epoch -e ip.src -e ip.dst \
  -e tls.handshake.extensions_server_name \
  -e tls.handshake.extensions_supported_group_list</code></pre><h2>3. Correlate with eBPF Runtime Events</h2><p>eBPF loader emits JSON lines keyed by TID, merging ClientHello + ServerHello -> negotiated group.</p><pre><code>{"ts":1693363200.123,"pid":1234,"tid":1234,"sni":"api.example.com","groups_offered":[29,23,24],"negotiated_group":29,"success":true}</code></pre><h2>4. Convert to CryptoBOM Observation</h2><pre><code>python integrations/runtime/ebpf_to_bom.py --in runtime.jsonl --out runtime.bom.json --asset-id host:demo</code></pre><h2>5. Link to Attestation</h2><p>The attestation aggregates observations, policy violations, and risk metrics. See <a href="sample_attestation.md">sample attestation</a>.</p><h2>Mapping Table (Example)</h2><table><tr><th>PCAP Field</th><th>Runtime Event</th><th>CryptoBOM</th></tr><tr><td>SNI</td><td>sni</td><td>observation.metadata.sni</td></tr><tr><td>Supported Groups</td><td>groups_offered</td><td>observation.metadata.groups</td></tr><tr><td>Negotiated Group</td><td>negotiated_group</td><td>observation.algorithms.negotiated.group</td></tr><tr><td>Handshake Success</td><td>success</td><td>observation.outcome</td></tr></table><h2>Next Steps</h2><ul><li>Add hybrid PQC group IDs as they are standardized.</li><li>Derive latency & failure mode metrics.</li><li>Cryptographic drift diffing across captures.</li></ul><p>© 2025 CarnotEngine Project (Apache-2.0)</p></body></html>
